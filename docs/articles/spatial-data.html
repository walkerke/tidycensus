<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spatial data in tidycensus • tidycensus</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Spatial data in tidycensus">
<meta property="og:description" content="tidycensus">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidycensus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.6.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic-usage.html">Basic usage of tidycensus</a>
    </li>
    <li>
      <a href="../articles/spatial-data.html">Spatial data in tidycensus</a>
    </li>
    <li>
      <a href="../articles/margins-of-error.html">Margins of error in the ACS</a>
    </li>
    <li>
      <a href="../articles/other-datasets.html">Other Census Bureau datasets</a>
    </li>
    <li>
      <a href="../articles/pums-data.html">Working with Census microdata</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/walkerke/tidycensus" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Spatial data in tidycensus</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/walkerke/tidycensus/blob/HEAD/vignettes/spatial-data.Rmd" class="external-link"><code>vignettes/spatial-data.Rmd</code></a></small>
      <div class="hidden name"><code>spatial-data.Rmd</code></div>

    </div>

    
    
<p>If requested, <strong>tidycensus</strong> can return simple feature
geometry for geographic units along with variables from the decennial US
Census or American Community survey. By setting
<code>geometry = TRUE</code> in a <strong>tidycensus</strong> function
call, <strong>tidycensus</strong> will use the <strong>tigris</strong>
package to retrieve the corresponding geographic dataset from the US
Census Bureau and pre-merge it with the tabular data obtained from the
Census API.</p>
<p>The following example shows median household income from the
2016-2020 ACS for Census tracts in Orange County, California:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://walker-data.com/tidycensus/" class="external-link">tidycensus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>tigris_use_cache <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">orange</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_acs.html">get_acs</a></span><span class="op">(</span></span>
<span>  state <span class="op">=</span> <span class="st">"CA"</span>,</span>
<span>  county <span class="op">=</span> <span class="st">"Orange"</span>,</span>
<span>  geography <span class="op">=</span> <span class="st">"tract"</span>,</span>
<span>  variables <span class="op">=</span> <span class="st">"B19013_001"</span>,</span>
<span>  geometry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  year <span class="op">=</span> <span class="fl">2020</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">orange</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 6 features and 5 fields</span></span>
<span><span class="co">## Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -118.0096 ymin: 33.77397 xmax: -117.7905 ymax: 33.93992</span></span>
<span><span class="co">## Geodetic CRS:  NAD83</span></span>
<span><span class="co">##         GEOID                                            NAME   variable</span></span>
<span><span class="co">## 1 06059110603 Census Tract 1106.03, Orange County, California B19013_001</span></span>
<span><span class="co">## 2 06059011503  Census Tract 115.03, Orange County, California B19013_001</span></span>
<span><span class="co">## 3 06059001102   Census Tract 11.02, Orange County, California B19013_001</span></span>
<span><span class="co">## 4 06059021812  Census Tract 218.12, Orange County, California B19013_001</span></span>
<span><span class="co">## 5 06059001301   Census Tract 13.01, Orange County, California B19013_001</span></span>
<span><span class="co">## 6 06059088701  Census Tract 887.01, Orange County, California B19013_001</span></span>
<span><span class="co">##   estimate   moe                       geometry</span></span>
<span><span class="co">## 1    56563 13103 MULTIPOLYGON (((-118.0096 3...</span></span>
<span><span class="co">## 2   101800 10306 MULTIPOLYGON (((-117.8984 3...</span></span>
<span><span class="co">## 3    99286 18207 MULTIPOLYGON (((-117.9765 3...</span></span>
<span><span class="co">## 4   133494  8958 MULTIPOLYGON (((-117.8184 3...</span></span>
<span><span class="co">## 5    75994 18045 MULTIPOLYGON (((-117.9766 3...</span></span>
<span><span class="co">## 6    54759  7682 MULTIPOLYGON (((-117.9673 3...</span></span></code></pre>
<p>Our object <code>orange</code> looks much like the basic
<strong>tidycensus</strong> output, but with a <code>geometry</code>
list-column describing the geometry of each feature, using the
geographic coordinate system NAD 1983 (EPSG: 4269) which is the default
for Census shapefiles. <strong>tidycensus</strong> uses the Census <a href="https://www.census.gov/geographies/mapping-files/time-series/geo/carto-boundary-file.html" class="external-link">cartographic
boundary shapefiles</a> for faster processing; if you prefer the
TIGER/Line shapefiles, set <code>cb = FALSE</code> in the function
call.</p>
<p>As the dataset is in a tidy format, it can be quickly visualized with
the <code>geom_sf</code> functionality currently in the development
version of <strong>ggplot2</strong>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">orange</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"magma"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="spatial-data_files/figure-html/unnamed-chunk-2-1.png" width="768"></p>
<p>Please note that the UTM Zone 11N coordinate system
(<code>26911</code>) is appropriate for Southern California but may not
be for your area of interest. For help identifying an appropriate
projected coordinate system for your data, take a look at <a href="https://github.com/walkerke/crsuggest" class="external-link">the {crsuggest} R
package</a>.</p>
<div class="section level2">
<h2 id="faceted-mapping">Faceted mapping<a class="anchor" aria-label="anchor" href="#faceted-mapping"></a>
</h2>
<p>One of the most powerful features of <strong>ggplot2</strong> is its
support for small multiples, which works very well with the tidy data
format returned by <strong>tidycensus</strong>. Many Census and ACS
variables return <em>counts</em>, however, which are generally
inappropriate for choropleth mapping. In turn,
<code>get_decennial</code> and <code>get_acs</code> have an optional
argument, <code>summary_var</code>, that can work as a multi-group
denominator when appropriate. Let’s use the following example of the
racial geography of Harris County, Texas. First, we’ll request data for
non-Hispanic whites, non-Hispanic blacks, non-Hispanic Asians, and
Hispanics by Census tract for the 2020 Census, using the PL-94171
summary file.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">racevars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>White <span class="op">=</span> <span class="st">"P2_005N"</span>, </span>
<span>              Black <span class="op">=</span> <span class="st">"P2_006N"</span>, </span>
<span>              Asian <span class="op">=</span> <span class="st">"P2_008N"</span>, </span>
<span>              Hispanic <span class="op">=</span> <span class="st">"P2_002N"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">harris</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_decennial.html">get_decennial</a></span><span class="op">(</span></span>
<span>  geography <span class="op">=</span> <span class="st">"tract"</span>,</span>
<span>  variables <span class="op">=</span> <span class="va">racevars</span>,</span>
<span>  state <span class="op">=</span> <span class="st">"TX"</span>,</span>
<span>  county <span class="op">=</span> <span class="st">"Harris County"</span>,</span>
<span>  geometry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  summary_var <span class="op">=</span> <span class="st">"P2_001N"</span>,</span>
<span>  year <span class="op">=</span> <span class="fl">2020</span>,</span>
<span>  sumfile <span class="op">=</span> <span class="st">"pl"</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">harris</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 6 features and 5 fields</span></span>
<span><span class="co">## Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -95.51535 ymin: 29.80887 xmax: -95.3994 ymax: 29.92537</span></span>
<span><span class="co">## Geodetic CRS:  NAD83</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">##   GEOID       NAME        variable value summary_value                  geometry</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;MULTIPOLYGON [°]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 48201530200 Census Tra… White     <span style="text-decoration: underline;">2</span>057          <span style="text-decoration: underline;">3</span>766 (((-95.45086 29.81984, -…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 48201530200 Census Tra… Black      127          <span style="text-decoration: underline;">3</span>766 (((-95.45086 29.81984, -…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 48201530200 Census Tra… Asian      239          <span style="text-decoration: underline;">3</span>766 (((-95.45086 29.81984, -…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 48201530200 Census Tra… Hispanic  <span style="text-decoration: underline;">1</span>154          <span style="text-decoration: underline;">3</span>766 (((-95.45086 29.81984, -…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 48201534002 Census Tra… White      388          <span style="text-decoration: underline;">5</span>653 (((-95.51398 29.92533, -…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> 48201534002 Census Tra… Black      685          <span style="text-decoration: underline;">5</span>653 (((-95.51398 29.92533, -…</span></span></code></pre>
<p>We notice that there are four entries for each Census tract, with
each entry representing one of our requested variables. The
<code>summary_value</code> column represents the value of the summary
variable, which is total population in this instance. When a summary
variable is specified in <code>get_acs</code>, both
<code>summary_est</code> and <code>summary_moe</code> columns will be
returned.</p>
<p>With this information, we can set up an analysis pipeline in which we
calculate a new percent-of-total column and visualize the result for
each group in a faceted plot.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">harris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>percent <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">value</span> <span class="op">/</span> <span class="va">summary_value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">variable</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"% of population\n(2020 Census)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="spatial-data_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="detailed-shoreline-mapping-with-tidycensus-and-tigris">Detailed shoreline mapping with tidycensus and tigris<a class="anchor" aria-label="anchor" href="#detailed-shoreline-mapping-with-tidycensus-and-tigris"></a>
</h2>
<p>Geometries in tidycensus default to the Census Bureau’s <a href="https://www.census.gov/geographies/mapping-files/time-series/geo/cartographic-boundary.html" class="external-link">cartographic
boundary shapefiles</a>. Cartographic boundary shapefiles are preferred
to the core <a href="https://www.census.gov/geo/maps-data/data/tiger-line.html" class="external-link">TIGER/Line
shapefiles</a> in tidycensus as their smaller size speeds up processing
and because they are pre-clipped to the US coastline.</p>
<p>However, there may be circumstances in which your mapping requires
more detail. A good example of this would be maps of New York City, in
which even the cartographic boundary shapefiles include water area. For
example, take this example of median household income by Census tract in
Manhattan (New York County), NY:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://walker-data.com/tidycensus/" class="external-link">tidycensus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>tigris_use_cache <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ny</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_acs.html">get_acs</a></span><span class="op">(</span>geography <span class="op">=</span> <span class="st">"tract"</span>, </span>
<span>              variables <span class="op">=</span> <span class="st">"B19013_001"</span>, </span>
<span>              state <span class="op">=</span> <span class="st">"NY"</span>, </span>
<span>              county <span class="op">=</span> <span class="st">"New York"</span>, </span>
<span>              year <span class="op">=</span> <span class="fl">2020</span>, </span>
<span>              geometry <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ny</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/dollar_format.html" class="external-link">dollar</a></span><span class="op">)</span></span></code></pre></div>
<p><img src="spatial-data_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
<p>As illustrated in the graphic, the boundaries of Manhattan include
water boundaries - stretching into the Hudson and East Rivers. In turn,
a more accurate representation of Manhattan’s land area might be
desired. To accomplish this, a tidycensus user can use the core
TIGER/Line shapefiles instead with the argument <code>cb = FALSE</code>,
then erase water area from Manhattan’s geometry. The
<code><a href="https://rdrr.io/pkg/tigris/man/erase_water.html" class="external-link">erase_water()</a></code> function in the <strong>tigris</strong> R
package will automatically remove proximate water areas from Census
polygons, improving cartographic display. The
<code>area_threshold</code> argument determines the percentile ranking
of the water areas by size in the data’s proximity to retain; the
default, 0.75, will keep the largest 25 percent of areas. Data should be
first transformed to a projected coordinate reference system to improve
performance.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/walkerke/tigris" class="external-link">tigris</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">ny_erase</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_acs.html">get_acs</a></span><span class="op">(</span></span>
<span>  geography <span class="op">=</span> <span class="st">"tract"</span>,</span>
<span>  variables <span class="op">=</span> <span class="st">"B19013_001"</span>,</span>
<span>  state <span class="op">=</span> <span class="st">"NY"</span>,</span>
<span>  county <span class="op">=</span> <span class="st">"New York"</span>,</span>
<span>  year <span class="op">=</span> <span class="fl">2020</span>,</span>
<span>  geometry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cb <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="fl">26918</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/tigris/man/erase_water.html" class="external-link">erase_water</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2020</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ny_erase</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/dollar_format.html" class="external-link">dollar</a></span><span class="op">)</span></span></code></pre></div>
<p><img src="spatial-data_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
<p>The map appears as before, but instead the polygons now hug the
shoreline of Manhattan. Setting the same <code>year</code> in
<code><a href="https://rdrr.io/pkg/tigris/man/erase_water.html" class="external-link">erase_water()</a></code> as your input data is recommended to avoid
<em>sliver polygons</em>, which are small polygons that can appear as a
result of misaligned overlay operations.</p>
</div>
<div class="section level2">
<h2 id="writing-to-shapefiles">Writing to shapefiles<a class="anchor" aria-label="anchor" href="#writing-to-shapefiles"></a>
</h2>
<p>Beyond this, you might be interested in writing your dataset to a
shapefile or GeoJSON for use in external GIS or visualization
applications. You can accomplish this with the <code>st_write</code>
function in the <strong>sf</strong> package:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_write.html" class="external-link">st_write</a></span><span class="op">(</span><span class="va">orange</span>, <span class="st">"orange.shp"</span><span class="op">)</span></span></code></pre></div>
<p>Your <strong>tidycensus</strong>-obtained dataset can now be used in
ArcGIS, QGIS, Tableau, or any other application that reads
shapefiles.</p>
<p>There is a lot more you can do with the spatial functionality in
<strong>tidycensus</strong>, including more sophisticated visualization
and spatial analysis; look for updates <a href="https://walkerke.github.io" class="external-link">on my blog</a> and in this space.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kyle Walker, Matt Herman.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
